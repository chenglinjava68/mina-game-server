<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

<mapper namespace="Mapper.User">

	<parameterMap type="User" id="userPM">
		<parameter property="username" />
		<parameter property="password" />
		<parameter property="email" />
		<parameter property="status" />
		<parameter property="regDate" />
		<parameter property="modDate" />
	</parameterMap>

	<resultMap type="User" id="userRM">
		<id property="id" column="id" />
		<result property="username" column="username" />
		<result property="password" column="password" />
		<result property="email" column="email" />
		<result property="status" column="status" />
		<result property="regDate" column="regDate" />
		<result property="modDate" column="modDate" />
		<collection property="players" column="player_id"
			select="Mapper.Player.getPlayerById"></collection>
	</resultMap>

	<insert id="create" parameterType="User" useGeneratedKeys="true">
		INSERT
		INTO t_user(username,password,email,status,regDate,modDate)
		VALUES(#{username},#{password},#{email},#{status},#{regDate},#{modDate})
	</insert>

	<update id="update" parameterType="User">
		UPDATE t_user SET
		username=#{username},
		password=#{password},
		email=#{email},
		status=#{status},
		regDate=#{regDate},
		modDate=#{modDate}
		WHERE id=#{id};
	</update>

	<delete id="delete" parameterType="int">
		DELETE FROM t_user WHERE
		id=#{id}
	</delete>

	<select id="getUserById" parameterType="int" resultMap="userRM">
		SELECT *
		FROM
		t_user WHERE id=#{id}
	</select>

	<select id="login" parameterType="map" resultType="User">
		SELECT * FROM
		t_user WHERE username=#{username} AND password=#{password}
	</select>
</mapper>